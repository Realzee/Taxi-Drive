<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="theme-color" content="#1A2A44">
    <title>TaxiDrive - Owner Dashboard</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="owner-dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script type="module" src="supabase-services.js"></script>
    <script type="module" src="owner-dashboard.js"></script>
</head>
<body class="owner-dashboard">
    <div class="dashboard-app">
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <img id="main-logo" src="assets/Logo1.png" alt="TaxiDrive Logo">
                </div>
                <div class="title-section">
                    <h1 class="app-title">TaxiDrive</h1>
                    <p id="owner-name" class="association-name">Owner Dashboard</p>
                </div>
                <div class="header-actions">
                    <button class="icon-btn notification-btn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-count">0</span>
                    </button>
                    <button class="icon-btn profile-btn" onclick="openProfileModal()">
                        <i class="fas fa-user"></i>
                    </button>
                    <button class="logout-btn btn btn-sm btn-danger" onclick="handleLogout()">Logout</button>
                </div>
            </div>
        </header>
        <main class="dashboard-container mt-20 pb-20">
            <section class="welcome-section">
                <h2>Welcome, <span id="user-name">Owner</span></h2>
                <p>Manage your fleet efficiently</p>
            </section>

            <section class="dashboard-overview">
                <h3 class="section-title">Dashboard Overview</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-car"></i></div>
                        <div class="stat-value" id="vehicles-count">0</div>
                        <div class="stat-label">Vehicles</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-value" id="drivers-count">0</div>
                        <div class="stat-label">Drivers</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-wallet"></i></div>
                        <div class="stat-value" id="earnings-balance">R 0.00</div>
                        <div class="stat-label">Earnings</div>
                    </div>
                </div>
            </section>

            <section class="quick-actions">
                <h3 class="section-title">Quick Actions</h3>
                <div class="actions-grid">
                    <button class="quick-action-btn" onclick="openAddVehicleModal()">
                        <i class="fas fa-car-side"></i>
                        Add Vehicle
                    </button>
                    <button class="quick-action-btn" onclick="openAddDriverModal()">
                        <i class="fas fa-user-plus"></i>
                        Add Driver
                    </button>
                    <button class="quick-action-btn" onclick="openWithdrawalModal()">
                        <i class="fas fa-money-bill-wave"></i>
                        Withdraw Funds
                    </button>
                </div>
            </section>

            <section class="fleet-management">
                <h3 class="section-title">Fleet Management</h3>
                <div id="fleet-list" class="list-container">
                    <!-- Vehicles will be rendered here -->
                </div>
            </section>

            <section class="driver-management">
                <h3 class="section-title">Driver Management</h3>
                <div id="driver-list" class="list-container">
                    <!-- Drivers will be rendered here -->
                </div>
            </section>

            <section class="financial-overview">
                <h3 class="section-title">Financial Overview</h3>
                <div class="financial-card">
                    <p>Current Balance: <span id="current-balance">R 0.00</span></p>
                    <button class="btn btn-primary" onclick="openWithdrawalModal()">Withdraw</button>
                </div>
                <h4 class="subsection-title">Transaction History</h4>
                <div id="transaction-history" class="list-container">
                    <!-- Transactions will be rendered here -->
                </div>
            </section>
        </main>

        <!-- Modals -->
        <div id="add-vehicle-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>Add Vehicle</h3>
                <form id="add-vehicle-form">
                    <div class="form-group">
                        <label for="vehicle-model">Model</label>
                        <input id="vehicle-model" type="text" required>
                    </div>
                    <div class="form-group">
                        <label for="vehicle-registration">Registration</label>
                        <input id="vehicle-registration" type="text" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('add-vehicle-modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Add</button>
                    </div>
                </form>
            </div>
        </div>

        <div id="edit-vehicle-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>Edit Vehicle</h3>
                <form id="edit-vehicle-form">
                    <input type="hidden" id="edit-vehicle-id">
                    <div class="form-group">
                        <label for="edit-vehicle-model">Model</label>
                        <input id="edit-vehicle-model" type="text" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-vehicle-registration">Registration</label>
                        <input id="edit-vehicle-registration" type="text" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('edit-vehicle-modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <div id="remove-vehicle-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>Confirm Removal</h3>
                <p>Are you sure you want to remove this vehicle?</p>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('remove-vehicle-modal')">Cancel</button>
                    <button id="confirm-remove-vehicle" class="btn btn-danger">Remove</button>
                </div>
            </div>
        </div>

        <!-- Similar modals for drivers -->
        <div id="add-driver-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>Add Driver</h3>
                <form id="add-driver-form">
                    <div class="form-group">
                        <label for="driver-name">Name</label>
                        <input id="driver-name" type="text" required>
                    </div>
                    <div class="form-group">
                        <label for="driver-license">License Number</label>
                        <input id="driver-license" type="text" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('add-driver-modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Add</button>
                    </div>
                </form>
            </div>
        </div>

        <div id="edit-driver-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>Edit Driver</h3>
                <form id="edit-driver-form">
                    <input type="hidden" id="edit-driver-id">
                    <div class="form-group">
                        <label for="edit-driver-name">Name</label>
                        <input id="edit-driver-name" type="text" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-driver-license">License Number</label>
                        <input id="edit-driver-license" type="text" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('edit-driver-modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <div id="remove-driver-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>Confirm Removal</h3>
                <p>Are you sure you want to remove this driver?</p>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('remove-driver-modal')">Cancel</button>
                    <button id="confirm-remove-driver" class="btn btn-danger">Remove</button>
                </div>
            </div>
        </div>

        <div id="withdrawal-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>Withdraw Funds</h3>
                <form id="withdrawal-form">
                    <div class="form-group">
                        <label for="withdrawal-amount">Amount</label>
                        <input id="withdrawal-amount" type="number" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('withdrawal-modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Withdraw</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>
</html>